简单总结：

1. 页与页之间是通过双链表来关联
2. 页内数据通过单链表来串联
3. 垃圾链表也通过单链表来串联

每个页面中的记录都划分成了若干个组，每个组中索引列值最大的记录在页内的偏移量会被当作槽依次存放在页目录中，因此可以通过二分法快递定位到索引列等于某个值的记录。



InnoDB为了不同的目的而设计了不同类型的页，我们把用于存放记录的页叫做 数据页。

Innodb数据页结构示意图

<img src="/Users/sh00050ml/Library/Application Support/typora-user-images/c_5_page_construct.png" alt="截屏2022-09-20 下午12.11.18" style="zoom:33%;" />

* File Header ，表示页的一些通用信息，占固定的38字节。

* Page Header ，表示数据页专有的一些信息，占固定的56个字节。

* Infimum + Supremum ，两个虚拟的伪记录，分别表示页中的最小和最大记录，占固定的 26 个字节。

* User Records ：真实存储我们插入的记录的部分，大小不固定。

* Free Space ：页中尚未使用的部分，大小不确定。Page Directory ：页中的某些记录相对位置，也就是各个槽在页面中的地址偏移量，大小不固定，插入的记录越多，这个部分占用的空间越多。

* File Trailer ：用于检验页是否完整的部分，占用固定的8个字节。



每个记录的头信息中都有一个 next_record 属性，从而使页中的所有记录串联成一个 单链表 。



InnoDB 会为把页中的记录划分为若干个组，每个组的最后一个记录的地址偏移量作为一个 槽 ，存放在Page Directory 中，所以在一个页中根据主键查找记录是非常快的，分为两步：

* 通过二分法确定该记录所在的槽。

* 通过记录的next_record属性遍历该槽所在的组中的各个记录。
* 

每个数据页的 File Header 部分都有上一个和下一个页的编号，所以所有的数据页会组成一个 双链表 。



为保证从内存中同步到磁盘的页的完整性，在页的首部和尾部都会存储页中数据的校验和和页面最后修改时对应的 LSN 值，如果首部和尾部的校验和和 LSN 值校验不成功的话，就说明同步过程出现了问题。

所有被删除掉的记录不会被立即删除，会被打上删除标记，他们会组成一个所谓的 垃圾链表。

将deleted_flag属性设置为1和将被删除的记录添加到垃圾链表中其实是两个阶段，后面undo日志会详细介绍。